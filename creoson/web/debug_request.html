<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
    <title>Responsive website template for documentations</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css" type="text/css">
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.css" type="text/css">
    <link rel="stylesheet" href="assets/plugins/prism/prism.css" type="text/css">
    <link rel="stylesheet" href="assets/plugins/lightbox/dist/ekko-lightbox.min.css" type="text/css">
    <link rel="stylesheet" href="assets/plugins/elegant_font/css/style.css" type="text/css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css" type="text/css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="shortcut icon" type="image/png" href="favicon.png"/>

</head>

<body class="body-red">
<div class="page-wrapper">
    <!-- ******Header****** -->
    <header id="header" class="header">
        <div class="container">
            <div class="branding">
                <h1 class="logo">
                    <a href="index.html">
                        <img src="img/CREOSON.png" style="max-width: 300px">
                    </a>
                </h1>
            </div><!--//branding-->
            <ol class="breadcrumb">
                <li><a href="index.html">Home</a></li>
                <li class="active">Showcase</li>
            </ol>
        </div><!--//container-->
    </header><!--//header-->
    <div class="doc-wrapper">
        <div class="container">
            <div id="doc-header" class="doc-header text-center">
                <h1 class="doc-title"><span aria-hidden="true" class="icon icon_cogs"></span> Playground</h1>
            </div><!--//doc-header-->
            <div id="showcase" class="doc-body">
                <div class="doc-content">
                    <div class="content-inner">

                        <section id="creosonOverview" class="doc-section">
                            <h2 id="theme-overview" class="section-title">Overview</h2>
                            <div class="section-block">
                                <p>Below is a diagram that provides a high-level overview of CREOSON</p>
                                <div class="text-center">
                                    <img src="img/HowCREOSONWorks.png" style="max-width: 650px;">
                                </div>

                                <p>The sections after this enable you to <span style="color: red">EXECUTE LIVE REQUESTS</span> to CREO Parametric via CREOSON JSON requests DIRECTLY from THIS WEBPAGE!</p>
                                <blockquote>This webpage <span style="color: red;"> does NOT use WebLink!</span><br> <br> This webpage is executing JavaScript JSON requests to the already running your CREOSON Server that is executing JLINK requests to the CREO Parametric Kernel.</blockquote>
                                <p>Give it a TRY!</p>
                            </div><!--//section-block-->
                        </section><!--//doc-section-->


                        <section id="connectToCreo" class="doc-section">
                            <h2 id="theme-start" class="section-title">Step 1 : CREOSON JSON Server</h2>
                            <div class="section-block">
                                <p>The first thing you must do is establish a connection to the CREOSON JSON Server, once you have successfully connected, you will get a 'sessionId'.</p>
                                <p>The sessionId value must be included in all subsequent calls/requests to CREO.</p>
                                <div class="row col-md-offset-1 col-md-12">
                                    <button id="creoson_connect" class="btn btn-green">Connect</button>
                                    <button id="creoson_disconnect" class="btn btn-default" disabled="disabled">Disconnect</button>
                                    <button id="creoson_showConnectTx" type="button" class="btn btn-blue icon arrow_left-right hidden"></button>
                                </div><!--//row-->
                            </div><!--//section-block-->
                        </section><!--//doc-section-->

                        <section id="openModelSection" class="doc-section creoControls hidden">
                            <h2 class="section-title">Step 2 : Open CREO Model(s)</h2>
                            <div class="section-block">
                                <p>Enter a model name and extension to load into CREO from the CREO current working directory.</p>
                                <p>NOTE: you <i>can</i> enter wildcard values for model names / extensions. :)</p>
                                <div class="row col-md-offset-1 col-md-12">
                                    <div class="row">
                                        <div id="creoson_openModelControls" class="navbar-form navbar-left">
                                            <div class="form-group">
                                                <input id="creoson_openModelRef" type="text" class="form-control" placeholder="<fileName>.<ext>">
                                            </div>
                                            <button id="creoson_openModel" type="button" class="btn btn-green">Open!</button>
                                            <button id="creoson_showOpenFileTx" type="button" class="btn btn-blue icon arrow_left-right hidden"></button>
                                        </div>
                                    </div><!-- /.row -->
                                </div>
                            </div><!--//section-block-->
                        </section><!--//doc-section-->

                        <section id="listParametersSection" class="doc-section creoControls hidden">
                            <h2 class="section-title">Step 3 : Parameter Search</h2>
                            <div class="section-block">
                                <p>Enter the name/value of a Parameter in your current/ active CREO Model</p>
                                <p>NOTE: you <i>can</i> enter wildcard values for parameter names and/or values. :)</p>
                                <div class="row col-md-offset-1 col-md-12">
                                    <div class="row">
                                        <div id="creoson_paramSearchControls" class="navbar-form navbar-left">
                                            <div class="form-group">
                                                <input id="creoson_paramNameRef" type="text" class="form-control" placeholder="name - * supported">
                                                <input id="creoson_paramValueRef" type="text" class="form-control" placeholder="value - * supported">
                                            </div>
                                            <button id="creoson_paramSearch" type="button" class="btn btn-green">Search!</button>
                                            <button id="creoson_paramTx" type="button" class="btn btn-blue icon arrow_left-right hidden"></button>
                                        </div>
                                    </div><!-- /.row -->
                                </div>
                                <div id="paramsTable" class="row, col-md-12">

                                        <!--DYNAMICALLY GENERATED PARAMETERS TABLE-->

                                </div>
                            </div><!--//section-block-->
                        </section><!--//doc-section-->


                    </div><!--//content-inner-->
                </div><!--//doc-content-->


                <div class="doc-sidebar">
                    <nav id="doc-nav">
                        <ul id="doc-menu" class="nav doc-menu hidden-xs" data-spy="affix">
                            <li>
                                <a class="scrollto" href="#creosonOverview">Overview</a>
                            </li>
                            <li>
                                <a class="scrollto" href="#connectToCreo">Step 1 - Connect To Creo</a>
                            </li>
                            <li>
                                <a class="scrollto" href="#openModelSection">Step 2 - Open Model</a>
                            </li>
                            <li>
                                <a class="scrollto" href="#listParametersSection">Step 3 - Param Search</a>
                            </li>
                        </ul><!--//doc-menu-->
                    </nav>
                </div><!--//doc-sidebar-->


            </div><!--//doc-body-->
        </div><!--//container-->
    </div><!--//doc-wrapper-->

    <div id="promo-block" class="promo-block promo-block-2">
        <div class="container">
            <div class="promo-block-inner">
                <h3 class="promo-title text-center"><i class="fa fa-heart"></i> <a href="http://www.simplifiedlogic.com" target="_blank">Nitro-CELL uses the core of CREOSON for Automation!</a></h3>
                <div class="row">
                    <div class="figure-holder col-md-5 col-sm-6 col-xs-12">
                        <div class="figure-holder-inner">
                            <a href="https://www.youtube.com/playlist?list=PLcWd1Ea7i_tzsmpZLOos9d30WVNsYXQ7z" target="_blank"><img class="img-responsive" src="img/YouTube-logo-full_color.png" alt="AppKit Theme" /></a>
                        </div>
                    </div><!--//figure-holder-->
                    <div class="content-holder col-md-7 col-sm-6 col-xs-12">
                        <div class="content-holder-inner">
                            <div class="desc">
                                <h4 class="content-title"><strong>CREO Automation using Excel?!</strong></h4>
                                <p><strong>YES!</strong> Check out Nitro-CELL!</p>
                                <p>Nitro-CELL drives CREO Parametric from any Excel Document.</p>
                                <p>Check out the Overview Videos, and Download a FREE Demo...</p>

                                <a class="btn btn-cta" href="http://download.nitromation.com/osgi/Nitro-CELL-win64.zip" target="_blank">Download 64-bit Nitro-CELL</a>
                                <a class="btn btn-cta" href="http://download.nitromation.com/osgi/Nitro-CELL-win32.zip" target="_blank">Download 32-bit Nitro-CELL</a>
                            </div><!--//desc-->
                            <div class="author"><a href="http://www.simplifiedlogic.com">- The Simplified Logic Development Team</a></div>
                        </div><!--//content-holder-inner-->
                    </div><!--//content-holder-->
                </div><!--//row-->
            </div><!--//promo-block-inner-->
        </div><!--//container-->
    </div><!--//promo-block-->

</div><!--//page-wrapper-->


<div class="modal fade" id="creosonModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">CREOSON Error</h4>
            </div>
            <div class="modal-body" id="creosonModalMessage">
                <p>Sorry - there was a problem with your request...</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->




<div class="modal fade" id="creoson_lastTransactionModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">CREOSON : Last Transactions</h4>
            </div>
            <div class="modal-body">
                <div role="tabpanel">
                <ul class="nav nav-tabs">
                    <li><a data-toggle="tab" href="#tab1">JSON Request</a></li>
                    <li><a data-toggle="tab" href="#tab2">JSON Response</a></li>
                </ul>

                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane fade" id="tab1">
                        <pre id="creosonLastRequest"  class="language-json" style="max-height: 300px;">
                        </pre>
                    </div>
                    <div role="tabpanel" id="tab2" class="tab-pane fade">
                        <pre id="creosonLastResponse" class="language-json" style="max-height: 300px;">
                        </pre>
                    </div>
                </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->





<footer class="footer text-center">
    <div class="container">
        <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can check out other license options via our website: themes.3rdwavemedia.com */-->

        <small class="copyright">CREOSON is NOT affiliated with PTC - so please do NOT contact PTC for Support!</small><br>
        <small class="copyright">CREOSON was developed and OpenSourced by Simplified Logic, Inc. Google Analytics used only for Documentation Usage</small><br>
        <small class="copyright">This Site was Perfectly Designed with <i class="fa fa-heart"></i> by <a href="http://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a>.</small>

    </div><!--//container-->
</footer><!--//footer-->


<!-- Main Javascript -->
<script type="text/javascript" src="assets/plugins/jquery-1.12.3.min.js"></script>
<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/plugins/prism/prism.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script>
<script type="text/javascript" src="assets/plugins/lightbox/dist/ekko-lightbox.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-match-height/jquery.matchHeight-min.js"></script>
<script type="text/javascript" src="assets/js/main.js"></script>

<!--Spec Table Generation-->
<script src="js/json2table.js" type="application/javascript"></script>
<link href="js/json2table.css" rel="stylesheet">



<!--CREOSON DEMO CODE-->
<script>

    function creosonRequest (dataObj) {

        // store the last request and format it
        $('#creosonLastRequest').text(JSON.stringify(dataObj,null,2));
        Prism.highlightElement($('#creosonLastRequest')[0]);

        return new Promise(function(resolve, reject) {

            $.ajax({
                url : '/creoson',
                port: 8000,
                dataType: "json",
                type: 'post',
                traditional : true,
                data: JSON.stringify(dataObj)
            })
                .success(function (data) {
                    console.log('got to the success : '+JSON.stringify(data))
                    console.log('got this data type back: '+typeof data);

                    // store the last request
                    $('#creosonLastResponse').text(JSON.stringify(data,null,2));
                    Prism.highlightElement($('#creosonLastResponse')[0]);

                    if (data.status.error) {
                        if (data.status.hasOwnProperty('message')) {
                            reject(data.status.message);
                        } else {
                            console.log(JSON.stringify(data));
                            reject('creoson Operation failed! - check console for details');
                        }

                    } else {
                        resolve(data);
                    }

                })
                .error( function (e) {
                    console.log('got an error : '+JSON.stringify(e));
                    reject('creoson Operation failed! - check console for details');

                });

        })

    }

    function enableCreoRequests() {

        $('#creosonOverview').addClass('hidden');

        $('#creoson_connect')
            .removeClass('btn-green')
            .addClass('btn-default')
            .attr('disabled','disabled');


        $('#creoson_disconnect')
            .removeClass('btn-default')
            .addClass('btn-red')
            .attr('disabled',null);

        $('.creoControls').removeClass('hidden');

    }
    function disableCreoRequests() {

        $('#creosonOverview').removeClass('hidden');

        $('#creoson_connect')
            .addClass('btn-green')
            .removeClass('btn-default')
            .attr('disabled',null);


        $('#creoson_disconnect')
            .addClass('btn-default')
            .removeClass('btn-red')
            .attr('disabled','disabled');

        $('.creoControls').addClass('hidden');

    }



    function creosonConnect() {
        // JSON request
        var reqObj =  {
            "command": "connection",
            "function": "connect"
        };

        // perform the request
        creosonRequest(reqObj)
            .then(function(respObj) {

                console.log('got this back: '+JSON.stringify(respObj));


                console.log('SESSIONID ===> '+respObj.sessionId);
                creosonSessionId = respObj.sessionId;

            }).then(function () {


            enableCreoRequests();

        }).then(function() {
            // reset the UI to display the Tx Buttons
            $('.btn-blue').addClass('hidden');
            $('#creoson_showConnectTx').removeClass('hidden');

        }).catch(function (err) {
            $('#creosonModalMessage').text(err);
            $('#creosonModal').modal('show');
        });
    }

    function creosonDisconenct() {

        // JSON request
        var reqObj =  {
            "command": "connection",
            "function": "disconnect"
        };

        // perform the request
        creosonRequest(reqObj)
            .then(function(respObj) {

                console.log('DISCONNECTED: '+JSON.stringify(respObj));
                disableCreoRequests();

            }).then(function() {
                // reset the UI to display the Tx Buttons
                $('.btn-blue').addClass('hidden');
                $('#creoson_showConnectTx').removeClass('hidden');
            }).catch(function (err) {
                    $('#creosonModalMessage').text(err);
                    $('#creosonModal').modal('show');
            });

    }



    function creoOpenModel () {

        // Clear out the last parameter results table
        $('#paramsTable').empty();

        // JSON request
        var reqObj =  {
            "sessionId": creosonSessionId,
            "command": "file",
            "function": "open",
            "data": {
                "file": null,
                "display": true,
                "activate": true
            }
        };

        // get the input value & set to the reqObj
        var fileName = $('#creoson_openModelRef').val();
        reqObj.data.file = fileName;

        // perform the request
        creosonRequest(reqObj)
            .then(function(respObj) {

                console.log('got this back: ' + JSON.stringify(respObj));

            }).then(function () {
                // reset the UI to display the Tx Buttons
                $('.btn-blue').addClass('hidden');
                $('#creoson_showOpenFileTx').removeClass('hidden');
            }).catch(function (err) {
                console.log('error : '+JSON.stringify(err));
                $('#creosonModalMessage').text(err);
                $('#creosonModal').modal('show');
        });

        //011034.prt
    }






    function genSpecTable (jsonObj,targetDiv) {
        $("#"+targetDiv).html(buildTable(jsonObj));
    }

    function creoParameterSearch () {

        // Clear out the last parameter results table
        $('#paramsTable').empty();

        // JSON request -- assume active model in CREO
        var reqObj =  {
            "sessionId": creosonSessionId,
            "command": "parameter",
            "function": "list",
            "data": {
            }
        };


        // get the input param name and value properties
        var nameMatch = $('#creoson_paramNameRef').val();
        var valueMatch = $('#creoson_paramValueRef').val();

        // Validate the values
        if (nameMatch.length > 0) {
            reqObj.data.name = nameMatch;
        }

        if (valueMatch.length > 0) {
            reqObj.data.value = valueMatch;
        }


        // perform the request
        creosonRequest(reqObj)
            .then(function(respObj) {

                console.log('got this back: '+JSON.stringify(respObj));

                genSpecTable(respObj,"paramsTable")

            }).then(function () {
                // reset the UI to display the Tx Buttons
                $('.btn-blue').addClass('hidden');
                $('#creoson_paramTx').removeClass('hidden');

            }).catch(function (err) {
                    $('#creosonModalMessage').text(err);
                    $('#creosonModal').modal('show');
            });

    }



    // set the CREOSON Defaults
    var creosonSessionId = -1;

    // initialize the events
    $().ready(

        $('#creoson_showConnectTx').on('click', function() {
            $('#creoson_lastTransactionModal').modal('show').ready(function () {
                $('.nav-tabs a[href="#tab1"]').tab('show');
            });

        }),

        $('#creoson_showOpenFileTx').on('click', function() {
            $('#creoson_lastTransactionModal').modal('show').ready(function () {
                $('.nav-tabs a[href="#tab1"]').tab('show');
            });

        }),

        $('#creoson_paramTx').on('click', function() {
            $('#creoson_lastTransactionModal').modal('show').ready(function () {
                $('.nav-tabs a[href="#tab1"]').tab('show');
            });

        }),

        $('#creoson_connect').on('click',function() {
            creosonConnect();
        }),

        $('#creoson_disconnect').on('click',function() {
            creosonDisconenct();
        }),


        $('#creoson_openModel').on('click', function () {
            creoOpenModel();
        }),

        $('#creoson_openModelRef').keypress(function(event){
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if(keycode == '13'){
                creoOpenModel();
            }
        }),


        $('#creoson_paramSearch').on('click', function () {
            creoParameterSearch();
        }),

        $('#creoson_paramNameRef').keypress(function(event){
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if(keycode == '13'){
                creoParameterSearch();
            }
        }),

        $('#creoson_paramValueRef').keypress(function(event){
            var keycode = (event.keyCode ? event.keyCode : event.which);
            if(keycode == '13'){
                creoParameterSearch();
            }

        })

    );

    // show controls for debugging
//    enableCreoRequests();


</script>


</body>
</html>

